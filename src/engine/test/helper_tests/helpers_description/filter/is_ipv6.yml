# Name of the helper function
name: is_ipv6

metadata:
  description: |
    Checks if the IP address stored in the field is an IPv6.
    IPv4:
      - 10.0.0.0
      - 172.16.0.0
      - 192.168.0.0
      - 127.0.0.0
    This helper function is typically used in the check stage

  keywords:
    - undefined

helper_type: filter

# Indicates whether the helper function supports a variable number of arguments
is_variadic: false

arguments:
  ip:
    type: string
    generate: ip
    source: reference


target_field:
  type:
    - number
    - string
    - object
    - boolean
    - array

test:
  - arguments:
      ip: 127.0.0.1
    target_field: any_value
    should_pass: false
    description: Invalid IPv6. It's an IPv4
  - arguments:
      ip: ::1
    target_field: any_value
    should_pass: true
    description: Valid special IPv6
  - arguments:
      ip: fd00:abcd::1234
    target_field: any_value
    should_pass: true
    description: Valid special IPv6
  - arguments:
      ip: 2a03:2880:f10c:83:face:b00c::25de
    target_field: any_value
    should_pass: true
    description: Valid public IPv6
